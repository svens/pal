#pragma once // -*- C++ -*-

#include <memory>

namespace pal::crypto::__algorithm {

// MD5 is deprecated, but it is required by turner library for
// STUN/TURN/MS-TURN integrity calculations

#define __pal_crypto_algorithm(Impl) \
	Impl(md5, MD5)

#define __pal_crypto_algorithm_api(Algorithm, unused) \
	struct Algorithm ## _hash \
	{ \
		struct impl_type; \
		std::unique_ptr<impl_type> impl; \
		\
		Algorithm ## _hash (); \
		~Algorithm ## _hash () noexcept; \
		\
		void update (const void *ptr, size_t size) noexcept; \
		void finish (void *digest) noexcept; \
	}

__pal_crypto_algorithm(__pal_crypto_algorithm_api);

#undef __pal_crypto_algorithm_api

} // namespace pal::crypto::__algorithm
